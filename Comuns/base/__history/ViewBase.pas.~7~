unit ViewBase;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.ExtCtrls, Vcl.StdCtrls, Vcl.Buttons, Data.DB, Data.Win.ADODB,
  Grids, DBGrids, Vcl.Themes;

type
  TfrmViewBase = class(TForm)
    pnl1: TPanel;
    pnl3: TPanel;
    pnl21: TPanel;
    pnl2: TPanel;
    pnl4: TPanel;
    nbMenu_Notebook: TNotebook;
    btn4: TSpeedButton;
    bvl: TBevel;
    Base: TADOConnection;
    btnSBAparencia: TSpeedButton;
    QueryConsulta: TADOQuery;
    procedure btn4Click(Sender: TObject);
    procedure btnSBAparenciaClick(Sender: TObject);
    procedure FormActivate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
    vCodUsuario: Integer;
  end;

var
  frmViewBase: TfrmViewBase;

implementation

uses
  Clientes, Aparencia;

{$R *.dfm}

procedure TfrmViewBase.btn4Click(Sender: TObject);
var
  i: Integer;
begin
  Application.CreateForm(TFormClientes, FormClientes);
  FormClientes.Show;
end;

procedure TfrmViewBase.btnSBAparenciaClick(Sender: TObject);
begin
  Application.CreateForm(TFormAparencia, FormAparencia);
  FormAparencia.Show;
end;

procedure TfrmViewBase.FormActivate(Sender: TObject);
begin
  vCodUsuario := 1;
  QueryConsulta.Close;
  QueryConsulta.SQL.Clear;
  QueryConsulta.SQL.Add('select EstiloDeSistema from Usuarios where CodUsuario = '+ IntToStr(vCodUsuario));
  QueryConsulta.Open;

  TStyleManager.TrySetStyle(QueryConsulta.FieldByName('EstiloDeSistema').AsString);
end;

end.
